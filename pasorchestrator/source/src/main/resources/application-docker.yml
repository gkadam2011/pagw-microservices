# PAGW Orchestrator - Docker Container Configuration
# This profile is for running inside Docker containers where service hostnames differ
# Environment variables aligned with Helm deployment templates
spring:
  # Database - uses standardized PAGW_AURORA_* variables
  datasource:
    url: jdbc:postgresql://${PAGW_AURORA_WRITER_ENDPOINT:pagw-postgres}:${PAGW_AURORA_PORT:5432}/${PAGW_AURORA_DATABASE:pagw}?currentSchema=pagw
    username: ${PAGW_AURORA_USERNAME:pagw}
    password: ${PAGW_AURORA_PASSWORD:pagw123}
    hikari:
      maximum-pool-size: ${PAGW_AURORA_MAX_POOL_SIZE:10}
      minimum-idle: ${PAGW_AURORA_MIN_IDLE:2}

  main:
    allow-bean-definition-overriding: true
    web-application-type: servlet

# PAGW Configuration - aligned with Helm deployment templates
pagw:
  application-id: ${PAGW_APPLICATION_ID:pasorchestrator}
  aws:
    endpoint: ${PAGW_AWS_ENDPOINT:http://pagw-localstack:4566}
    region: ${AWS_REGION:us-east-2}
    aurora:
      writer-endpoint: ${PAGW_AURORA_WRITER_ENDPOINT:pagw-postgres}
      database: ${PAGW_AURORA_DATABASE:pagw}
      port: ${PAGW_AURORA_PORT:5432}
    s3:
      enabled: true
      # Primary bucket for all request lifecycle data (raw/, enriched/, final/, attachments/)
      request-bucket: ${PAGW_S3_REQUEST_BUCKET:pagw-request-local}
      # Bucket for audit logs and operational data
      audit-bucket: ${PAGW_S3_AUDIT_BUCKET:pagw-audit-local}
    sqs:
      enabled: true
      request-queue: ${PAGW_SQS_REQUEST_QUEUE:}
      response-queue: ${PAGW_SQS_RESPONSE_QUEUE:}
      dlq: ${PAGW_SQS_DLQ:}
    secrets:
      enabled: false
    kms:
      enabled: false
    dynamodb:
      enabled: false

  # Encryption disabled
  encryption:
    enabled: false
    encrypt-phi-fields: false

  # Storage
  storage:
    bucket: pagw-storage-local
    attachmentBucket: pagw-attachments-local

  # SQS Queues - use LocalStack container hostname
  queues:
    requestParser: http://pagw-localstack:4566/000000000000/pagw-request-parser-queue
    businessValidator: http://pagw-localstack:4566/000000000000/pagw-business-validator-queue
    requestEnricher: http://pagw-localstack:4566/000000000000/pagw-request-enricher-queue
    attachmentHandler: http://pagw-localstack:4566/000000000000/pagw-attachment-handler-queue
    canonicalMapper: http://pagw-localstack:4566/000000000000/pagw-canonical-mapper-queue
    apiOrchestrator: http://pagw-localstack:4566/000000000000/pagw-api-connector-queue
    responseBuilder: http://pagw-localstack:4566/000000000000/pagw-response-builder-queue
    callbackHandler: http://pagw-localstack:4566/000000000000/pagw-callback-handler-queue
    outboxPublisher: http://pagw-localstack:4566/000000000000/pagw-outbox-publisher-queue
    replay: http://pagw-localstack:4566/000000000000/pagw-replay-queue

  # Internal service URLs - use container hostnames
  services:
    request-parser:
      url: http://pagw-request-parser:8081
    business-validator:
      url: http://pagw-business-validator:8082
    parserUrl: http://pagw-request-parser:8081
    validatorUrl: http://pagw-business-validator:8082
    enricherUrl: http://pagw-request-enricher:8083
    attachmentUrl: http://pagw-attachment-handler:8084
    mapperUrl: http://pagw-request-converter:8085
    apiConnectorUrl: http://pagw-api-connector:8086
    responseBuilderUrl: http://pagw-response-builder:8087
    callbackUrl: http://pagw-callback-handler:8088
    providerAuthUrl: http://pagw-provider-auth:8090

  # Sync processing disabled for Docker
  sync:
    enabled: false

  # Auth disabled for local
  auth:
    enabled: false

# Logging - reduce verbosity for containers
logging:
  level:
    root: INFO
    com.anthem.pagw: DEBUG
    org.springframework.web: INFO
    org.hibernate.SQL: DEBUG
